{% extends 'base.html' %} 
{% load static %}
{% block content %}

{% if messages %}
  {% for msg in messages %}
    <div class="alert alert-info alert-dismissable">
      <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
      {{msg.message}}
    </div>
  {% endfor %}
{% endif %}

<meta charset="utf-8">
<div class="col-md-8">
<div id="donut-charts">
</div>
</div>
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src={% static "js/home.js" %} charset="utf-8"></script>

<div class="col-md-4">
  <div class="panel panel-info">
    <div class="panel-body">
      
      <h4>
        <span class="glyphicon glyphicon glyphicon-tags" aria-hidden="true"></span>
        &nbsp; Notifications
      </h4>

      <hr style="border-color:inherit"/>

      {% for n in new_files_list %}
      <div>
        <p> 
            <a>New file {{n.file_name}}</a> 
            <br>
            <button id="{{n.file_name}}/" value="{{n.file_name}}/" name="auto_assign_file_path" onclick="autoassign(this.value)"> Auto Assign</button>
            
            <form action="/tag/assignTags" method="post">
            {% csrf_token %}
                <button id="{{n.file_name}}/" value="{{n.file_name}}/" name="file_path"> Manual Assign</button>
            </form> 
      </div>
        
      {% endfor %}
    </div>
  </div>
</div>

<script type="text/javascript">
  function autoassign(value){
    console.log(value);
    console.log(this.value);
  var dct = {};dct = {'auto_assign_file_path': value};
  $.ajax({
         url: "/tag/autoAssign/",
         type: "POST",
         data: dct,
         async: 'true',
         success: function(data) {
          alert(data);
          location.href = "/"
         },
         error:function(data) {
             console.log(data.responseText)
             alert("error in getting from server")
         },
  });
};
  
</script>


{% endblock %}
